## 简述

begoina可以通过加载模块的形式，增强套件的功能。

begonia源码中提供的模块在功能上都是相互独立，除了一些模块使用了`util.js`提供的实用工具外，模块与模块之间没有相互依赖(bex目录中的多个js文件是互相依赖的，但是它们已经集中在一个目录，并且只有一个外部可见的主文件入口`bex.js`)。

开发自定义模块，主要在于实现规定的接口，同时需要仔细的考虑模块的可插拔功能。

## 模块接口定义

开发增强模块，需要有一个模块的主入口，并导出一个对象，应当包含有以下方法和属性:

```js
export default {
    /**
     * 设置debug模式
     */
    set debug(value){},
    get debug(){},
    /**
     * 装饰者函数 
     * @param {ViewModelProxy} vmp [necessary] vmp实例对象
     */
    decorator(vmp){},
    /**
     * @public
     * 
     * 启动增强模块
     * @param {Object} config [optional] 模块设置
     * 
     * 如果设置了`config`参数并且模块也提供了`setup`方法，
     * 那么这个`config`对象将会作为`setup()`的参数传入模块中。
     * 模块利用其进行初始化配置。
     */
    setup(config){},
    /**
     * 销毁模块，不可再用
     */ 
    destroy(){},
};
```

>**begoina对模块的要求并不严格，以上只是一个建议，并不要求都需要实现。**

虽然都没有严格要求必须实现这些方法，但也有推荐实现的:

- `debug` 存取器，可以提供debug模式供开发者使用。
- `destroy()` 销毁方法，提供一个可靠的销毁方法，便于在必要时执行模块清理。

### `decorator`方法

`decorator`是用来包装begoina中的VMP(View Model Proxy)实例对象。
在这个函数中，可以根据模块的需要，将一些方法或者属性附加在vmp对象上。
这样在小程序页面或组件的使用中，可以通过直接通过`this.vmp.[prop]`访问属性；可以通过`this.vmp.[method]()`方式调用方法，从而使用模块所提供的功能。

### `setup`方法

`setup`是用来启动增强模块的，它会在begoina启动的时候再内部调用。
如果模块需要伴随着begoina启动时初始化，那么就从定义这个方法开始吧。

#### 参数

- `config` 可选配置对象，如果模块的初始化需要进行配置，则可以在装载模块的时候，加入这个配置文件。
这样在begonia启动的时候，也会传入这个配置文件，使模块可以自定义。

```js
BE.use(someModule,{
    // config object
});
```

### `destroy`方法

`destroy`可以用来销毁模块，这出现在不需要模块，并将被删除时。设置可靠的销毁流程，从而释放占用的资源，可以在必要时对系统进行清理。

## 安装增强模块

使用`begoina.use()`方法，将模块的导出对象传入其中即可。

例如，安装`bex`模块

```js
//装载bex模块
BE.use(bex);

// 有配置文件的模块
BE.use(someModule,{
    // config object
});

```

执行安装，并不一定要在`app.js`中进行。可以在另外的文件A中进行设置，在`app.js`中导入A。
这样有利于相关性代码的管理。
## 简述

begonia提供的是一个核心的功能，直白的讲就是一个对对象的包装和导出。
其他的功能都是通过加载模块的形式，增强的功能。

在这里，begonia提供了一个模块的生命周期，通过钩子函数，可以细粒度的控制各个环节，基本涵盖了从加载原始声明文件到导出用于小程序的对象的过程。

开发自定义模块，主要在于实现模块的生命周期，同时需要仔细的考虑模块的可插拔特性。

## 模块声明周期

### 阶段

#### 启动模块

在运行时中，装载模块之后会立即调用该方法，启动模块。

其中的参数`config`来源于`BE.use(module, config)`方法，第二个参数，默认为纯对象。

```js
function setup(config:any):void
```

> 非必须设置的声明周期钩子

#### 解析原始声明对象

```js
function originParse(obj:any, type:number):void
```

发生在导出小程序可用的对象实例之前，用于模块解析原始的声明式开发对象，作为初级配置使用。

参数:
- `obj` 原始的声明式开发对象
- `type` 当前的文件类型，App->1, Page->2, Component->3 

> 非必须设置的声明周期钩子

#### 初始化vmp

```js
function initVMP(master) {}
```

此方法目前只有VMP模块可以使用，用以创建`VMProxy`实例，其参数`master`，即小程序运行时的app对象/page对象/component对象

> 对于VMP模块是必须的钩子，对于其他模块则是非必须设置的声明周期钩子

#### 装饰小程序实例对象和vmp对象

```js
function decorate(master, vmp) {}
```

用于模块将特有的方法或者属性，挂载到小程序实例或者vmp实例上

请注意：此时应当仅仅进行装饰和挂载方法和属性的操作，因为模块实例还没有进行原始的对象进行解析。

> 非必须设置的声明周期钩子

#### 解析模块

```js
function parse(master, vmp) {}
```

解析模块发生在小程序实例对象(`master`)对应的`VMP`对象实例(`vmp`)已经被创建之后。

用于模块完成对`masert`和`vmp`的设置

> 非必须设置的声明周期钩子

#### 清洗小程序实例对象和vmp对象

```js
function wash(master, vmp) {}
```

在模块卸载时(调用`BE.unload(module)`)，小程序对象实例被释放时(`onUnload`被调用时)，对调用此声明周期钩子。

模块可以对小程序实例和vmp实例进行清理，等待模块被销毁或者vmp被销毁

> 非必须设置的声明周期钩子

#### 销毁vmp对象

```js
function destroyVMP(master, vmp) {}
```

此方法目前只有VMP模块可用，用于销毁小程序实例对应的vmp对象。它总是在所有需要调用wash方法的模块都被遍历之后，才会被VMP调用。

> 非必须设置的声明周期钩子

#### 卸载模块之前

```js
function beforeUnload() {}
```

当模块被卸载时(调用`BE.unload(module)`)，模块的此方法会被调用，可以用来做清理工作。

> 非必须设置的声明周期钩子

#### 销毁模块

```js
function destroy() {}
```
当模块需要被销毁时，此模块方法会被调用。

注意：销毁不是重置，是毁坏等待被回收。在小程序进程运行时中，此模块被废弃，也不能再被使用。

> 必须设置的声明周期钩子

